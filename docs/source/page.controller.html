<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * Created with JetBrains RubyMine.
 * User: teamco
 * Date: 11/17/12
 * Time: 4:10 PM
 * To change this template use File | Settings | File Templates.
 */

define([
    &#39;modules/controller&#39;,
    &#39;modules/page&#39;
], function definePageController(BaseController, BasePage) {

<span id='Controller-method-constructor'><span id='Controller'>    /**
</span></span>     * Define page controller
     * @class Controller
     * @mixin {BaseController, BasePage}
     * @constructor
     */
    var Controller = function Controller() {

    };

    return Controller.extend({

<span id='Controller-method-isAllowAddWidget'>        /**
</span>         * Check if allowed to add widget to page
         */
        isAllowAddWidget: function isAllowAddWidget() {
            var allow = this.model.getConfig(&#39;widget&#39;).allowToAdd;
            this.scope.logger.debug(&#39;Is allowed to add widget?&#39;, allow);
            return allow;
        },

<span id='Controller-method-allowAddWidget'>        /**
</span>         * Allow to add widget to page
         */
        allowAddWidget: function allowAddWidget() {
            this.scope.logger.debug(&#39;Allow to add widget&#39;);
            this.model.getConfig(&#39;widget&#39;).allowToAdd = true;
        },

<span id='Controller-method-banAddWidget'>        /**
</span>         * Do not allow to add widget to page
         */
        banAddWidget: function banAddWidget() {
            this.scope.logger.debug(&#39;Do not allow to add widget&#39;);
            this.model.getConfig(&#39;widget&#39;).allowToAdd = false;
        },

        setPageHeight: function setPageHeight() {
//            this.view.elements.$page.defineHeight();
        },

<span id='Controller-method-getWidgetsContainer'>        /**
</span>         * Get widgets container
         * @returns {*}
         */
        getWidgetsContainer: function getWidgetsContainer() {
            return this.scope.view.elements.$widgets;
        },

<span id='Controller-method-downgradeLayer'>        /**
</span>         * Downgrade widgets layer except widget
         * @param {{model, view}} widget
         */
        downgradeLayer: function downgradeLayer(widget) {
            var items = this.model.getItems(),
                item, index;

            for (index in items) {
                if (items.hasOwnProperty(index)) {
                    item = items[index];

                    if (widget.model.getUUID() !== item.model.getUUID()) {
                        item.view.elements.$widget._downgradeLayer(50);
                    }
                }
            }

            widget.view.elements.$widget._downgradeLayer(51);
        }

    }, BaseController.prototype, BasePage.prototype);
});</pre>
</body>
</html>
