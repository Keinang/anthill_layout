<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * Created with JetBrains RubyMine.
 * User: teamco
 * Date: 5/6/13
 * Time: 9:03 PM
 */
define([
    &#39;config/anthill&#39;
], function defineDebuggerWidget(AntHill) {

<span id='DebuggerWidget-method-constructor'><span id='DebuggerWidget'>    /**
</span></span>     * Define Debugger Widget
     * @param {*} debug
     * @class DebuggerWidget
     * @constructor
     */
    var DebuggerWidget = function DebuggerWidget(debug) {

<span id='DebuggerWidget-property-bugger'>        /**
</span>         * Define debugger
         * @type {Debugger}
         */
        this.bugger = debug;
    };

    return DebuggerWidget.extend({

        getWidget: function getWidget() {
            return this.bugger.scopes.widget;
        },

        renderAttributes: function renderAttributes() {
            var c = this.bugger.component,
                w = this.getWidget(),
                attr = w.model.getAttributes(),
                base = this.base;

            return [
                &#39;&lt;li class=&quot;extend&quot;&gt;&#39;,
                c.renderBlock(
                    &#39;Attributes&#39;, [
                        $.map(attr,function (v, k) {
                            return base.isBoolean(v) ?
                                c.renderInput(k.toUnderscore().humanize(), v) :
                                null;
                        }).join(&#39;&#39;),
                        c.renderCombo(
                            &#39;Magnet mode&#39;,
                            attr.magnet,
                            w.CONSTANTS.magnet
                        )
                    ], false
                ),
                &#39;&lt;/li&gt;&#39;
            ].join(&#39;&#39;);
        },

<span id='DebuggerWidget-method-renderInteractionComponent'>        /**
</span>         * Render Interaction component
         * @param {*|Array} capability
         * @param {String} name
         * @returns {string}
         */
        renderInteractionComponent: function renderInteractionComponent(capability, name) {
            var c = this.bugger.component;
            return [
                &#39;&lt;li class=&quot;extend fl mr10&quot;&gt;&#39;,
                c.renderBlock(
                    name,
                    $.map(capability, function (v, k) {
                        return c.renderInput(
                            v.toUnderscore().humanize(),
                            v
                        );
                    }),
                    false
                ),
                &#39;&lt;/li&gt;&#39;
            ].join(&#39;&#39;);
        },

<span id='DebuggerWidget-method-renderInteractions'>        /**
</span>         * Render Interaction capabilities
         * @returns {string}
         */
        renderInteractions: function renderInteractions() {
            var c = this.bugger.component,
                widget = this.getWidget();

            var dragHTML = this.renderInteractionComponent(
                    widget.permission.draggableCapabilities() || [],
                    &#39;Draggable&#39;
                ),
                resizeHTML = this.renderInteractionComponent(
                    widget.permission.resizableCapabilities() || [],
                    &#39;Resizeable&#39;
                );

            return [
                &#39;&lt;li class=&quot;extend&quot;&gt;&#39;,
                c.renderBlock(
                    &#39;Interactions&#39;,
                    [dragHTML, resizeHTML],
                    false
                ),
                &#39;&lt;/li&gt;&#39;
            ].join(&#39;&#39;);
        },

<span id='DebuggerWidget-method-bindChangeOverlappingMode'>        /**
</span>         * Bind change overlapping mode
         */
        bindChangeOverlappingMode: function bindChangeOverlappingMode() {
            $(&#39;#overlapping-mode&#39;).on(&#39;change.overlapping&#39;, function onChange(e) {
                this.bugger.scopes.page.layout.controller.setOrganizeMode($(e.target).val());
            }.bind(this));
        },

<span id='DebuggerWidget-method-renderWidgetInfo'>        /**
</span>         * Render widget info
         * @param {{type, timeStamp}} event
         * @param {{originalPosition, originalSize, offset, position, helper}} ui
         * @returns {string|boolean}
         */
        renderWidgetInfo: function renderWidgetInfo(event, ui) {

            if (!this.bugger.scopes.widget) {
                return false;
            }

            var c = this.bugger.component;

            return [
                c.renderInline(&#39;UUID&#39;, this.bugger.scopes.widget.config.uuid),
                this.renderAttributes(),
                this.renderInteractions(),
                &#39;&lt;li class=&quot;extend&quot;&gt;&#39;,
                c.renderBlock(&#39;Dimensions&#39;, this.renderDimensionsInfo(event, ui), false),
                &#39;&lt;/li&gt;&#39;
            ].join(&#39;&#39;)
        },

        renderDimensionsInfo: function renderDimensionsInfo(event, ui) {
            var c = this.bugger.component,
                widget = this.getWidget(),
                widgetDOM = widget.map.getDOM(),

                originalPosition = ui.originalPosition || {},
                originalSize = ui.originalSize || {},
                offset = ui.offset || {},
                position = ui.position || {},
                helper = ui.helper || $(),

                columnAllowLeft = widget.map.checkWidgetPositionColumnLeft(widgetDOM.column),
                columnAllowRight = widget.map.checkWidgetPositionColumnRight(widgetDOM),
                rowAllowTop = widget.map.checkWidgetPositionRowTop(widgetDOM.row);

<span id='DebuggerWidget-method-getAllowedColumn'>            /**
</span>             * Get allowed column
             * @returns {string}
             */
            function getAllowedColumn() {
                return [
                    &#39;&lt;span class=&quot;left-&#39;, columnAllowLeft, &#39;&quot;&gt;Left&lt;/span&gt;|&#39;,
                    &#39;&lt;span class=&quot;right-&#39;, columnAllowRight, &#39;&quot;&gt;Right&lt;/span&gt;&#39;
                ].join(&#39;&#39;);
            }

<span id='DebuggerWidget-method-getAllowedRow'>            /**
</span>             * Get allowed row
             * @returns {string}
             */
            function getAllowedRow() {
                return [&#39;&lt;span class=&quot;top-&#39;, rowAllowTop, &#39;&quot;&gt;Top&lt;/span&gt;&#39;].join(&#39;&#39;);
            }

            return [
                c.renderInline(&#39;On&#39;, (event.type + &#39;&#39;).toUpperCase()),
                &#39;&lt;li&gt;&lt;table&gt;&#39;,
                c.renderTableRow(&#39;Location&#39;, &#39;Left&#39;, &#39;Top&#39;, true),
                c.renderTableRow(&#39;Offset&#39;, Number(offset.left).toFixed(3), Number(offset.top).toFixed(3), false),
                c.renderTableRow(&#39;Original position&#39;, Number(originalPosition.left).toFixed(3), Number(originalPosition.top).toFixed(3), false),
                c.renderTableRow(&#39;Position&#39;, Number(position.left).toFixed(3), Number(position.top).toFixed(3), false),
                c.renderTableRow(&#39;Dimensions&#39;, &#39;Width&#39;, &#39;Height&#39;, true),
                c.renderTableRow(&#39;Original size&#39;, originalSize.width, originalSize.height, false),
                c.renderTableRow(&#39;Size&#39;, helper.width(), helper.height(), false),
                c.renderTableRow(&#39;Grid&#39;, &#39;Column&#39;, &#39;Row&#39;, true),
                c.renderTableRow(&#39;Position&#39;, widgetDOM.column, widgetDOM.row, false),
                c.renderTableRow(&#39;Relative dimensions&#39;, widgetDOM.relWidth, widgetDOM.relHeight, false),
                c.renderTableRow(&#39;Position&#39;, &#39;Column&#39;, &#39;Row&#39;, true),
                c.renderTableRow(&#39;Allowed&#39;, getAllowedColumn(), getAllowedRow(), false),
                &#39;&lt;/table&gt;&lt;/li&gt;&#39;,
                c.renderInline(&#39;Timestamp&#39;, event.timeStamp)
            ];
        },

<span id='DebuggerWidget-method-updateWidgetInfo'>        /**
</span>         * Update widget info
         * @param {{map, config}} widget
         * @param {{type, timeStamp}} event
         * @param {{originalPosition, offset, position, helper}} ui
         */
        updateWidgetInfo: function updateWidgetInfo(widget, event, ui) {
            this.bugger.scopes.widget = widget;
            $(&#39;.dimensions-info ul&#39;, &#39;.widget-info&#39;).empty().append(this.renderDimensionsInfo(event, ui).join(&#39;&#39;));
        }

    }, AntHill.prototype);

});
</pre>
</body>
</html>
