<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">tinymce._beforeUnloadHandler=function(){var a;return tinymce.each(tinymce.editors,function(b){b.plugins.autosave&amp;&amp;b.plugins.autosave.storeDraft(),!a&amp;&amp;b.isDirty()&amp;&amp;b.getParam(&quot;autosave_ask_before_unload&quot;,!0)&amp;&amp;(a=b.translate(&quot;You have unsaved changes are you sure you want to navigate away?&quot;))}),a},tinymce.PluginManager.add(&quot;autosave&quot;,function(a){function b(a,b){var c={s:1e3,m:6e4};return a=/^(\d+)([ms]?)$/.exec(&quot;&quot;+(a||b)),(a[2]?c[a[2]]:1)*parseInt(a,10)}function c(){var a=parseInt(n.getItem(k+&quot;time&quot;),10)||0;return(new Date).getTime()-a&gt;m.autosave_retention?(d(!1),!1):!0}function d(b){n.removeItem(k+&quot;draft&quot;),n.removeItem(k+&quot;time&quot;),b!==!1&amp;&amp;a.fire(&quot;RemoveDraft&quot;)}function e(){!j()&amp;&amp;a.isDirty()&amp;&amp;(n.setItem(k+&quot;draft&quot;,a.getContent({format:&quot;raw&quot;,no_events:!0})),n.setItem(k+&quot;time&quot;,(new Date).getTime()),a.fire(&quot;StoreDraft&quot;))}function f(){c()&amp;&amp;(a.setContent(n.getItem(k+&quot;draft&quot;),{format:&quot;raw&quot;}),a.fire(&quot;RestoreDraft&quot;))}function g(){l||(setInterval(function(){a.removed||e()},m.autosave_interval),l=!0)}function h(){var b=this;b.disabled(!c()),a.on(&quot;StoreDraft RestoreDraft RemoveDraft&quot;,function(){b.disabled(!c())}),g()}function i(){a.undoManager.beforeChange(),f(),d(),a.undoManager.add()}function j(b){var c=a.settings.forced_root_block;return b=tinymce.trim(&quot;undefined&quot;==typeof b?a.getBody().innerHTML:b),&quot;&quot;===b||new RegExp(&quot;^&lt;&quot;+c+&quot;[^&gt;]*&gt;((\xa0|&amp;nbsp;|[ 	]|&lt;br[^&gt;]*&gt;)+?|)&lt;/&quot;+c+&quot;&gt;|&lt;br&gt;$&quot;,&quot;i&quot;).test(b)}var k,l,m=a.settings,n=tinymce.util.LocalStorage;k=m.autosave_prefix||&quot;tinymce-autosave-{path}{query}-{id}-&quot;,k=k.replace(/\{path\}/g,document.location.pathname),k=k.replace(/\{query\}/g,document.location.search),k=k.replace(/\{id\}/g,a.id),m.autosave_interval=b(m.autosave_interval,&quot;30s&quot;),m.autosave_retention=b(m.autosave_retention,&quot;20m&quot;),a.addButton(&quot;restoredraft&quot;,{title:&quot;Restore last draft&quot;,onclick:i,onPostRender:h}),a.addMenuItem(&quot;restoredraft&quot;,{text:&quot;Restore last draft&quot;,onclick:i,onPostRender:h,context:&quot;file&quot;}),a.settings.autosave_restore_when_empty!==!1&amp;&amp;(a.on(&quot;init&quot;,function(){c()&amp;&amp;j()&amp;&amp;f()}),a.on(&quot;saveContent&quot;,function(){d()})),window.onbeforeunload=tinymce._beforeUnloadHandler,this.hasDraft=c,this.storeDraft=e,this.restoreDraft=f,this.removeDraft=d,this.isEmpty=j});</pre>
</body>
</html>
