<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">tinymce.PluginManager.add(&quot;layer&quot;,function(a){function b(a){do if(a.className&amp;&amp;-1!=a.className.indexOf(&quot;mceItemLayer&quot;))return a;while(a=a.parentNode)}function c(b){var c=a.dom;tinymce.each(c.select(&quot;div,p&quot;,b),function(a){/^(absolute|relative|fixed)$/i.test(a.style.position)&amp;&amp;(a.hasVisual?c.addClass(a,&quot;mceItemVisualAid&quot;):c.removeClass(a,&quot;mceItemVisualAid&quot;),c.addClass(a,&quot;mceItemLayer&quot;))})}function d(c){var d,e,f=[],g=b(a.selection.getNode()),h=-1,i=-1;for(e=[],tinymce.walk(a.getBody(),function(a){1==a.nodeType&amp;&amp;/^(absolute|relative|static)$/i.test(a.style.position)&amp;&amp;e.push(a)},&quot;childNodes&quot;),d=0;d&lt;e.length;d++)f[d]=e[d].style.zIndex?parseInt(e[d].style.zIndex,10):0,0&gt;h&amp;&amp;e[d]==g&amp;&amp;(h=d);if(0&gt;c){for(d=0;d&lt;f.length;d++)if(f[d]&lt;f[h]){i=d;break}i&gt;-1?(e[h].style.zIndex=f[i],e[i].style.zIndex=f[h]):f[h]&gt;0&amp;&amp;(e[h].style.zIndex=f[h]-1)}else{for(d=0;d&lt;f.length;d++)if(f[d]&gt;f[h]){i=d;break}i&gt;-1?(e[h].style.zIndex=f[i],e[i].style.zIndex=f[h]):e[h].style.zIndex=f[h]+1}a.execCommand(&quot;mceRepaint&quot;)}function e(){var b=a.dom,c=b.getPos(b.getParent(a.selection.getNode(),&quot;*&quot;)),d=a.getBody();a.dom.add(d,&quot;div&quot;,{style:{position:&quot;absolute&quot;,left:c.x,top:c.y&gt;20?c.y:20,width:100,height:100},&quot;class&quot;:&quot;mceItemVisualAid mceItemLayer&quot;},a.selection.getContent()||a.getLang(&quot;layer.content&quot;)),tinymce.Env.ie&amp;&amp;b.setHTML(d,d.innerHTML)}function f(){var c=b(a.selection.getNode());c||(c=a.dom.getParent(a.selection.getNode(),&quot;DIV,P,IMG&quot;)),c&amp;&amp;(&quot;absolute&quot;==c.style.position.toLowerCase()?(a.dom.setStyles(c,{position:&quot;&quot;,left:&quot;&quot;,top:&quot;&quot;,width:&quot;&quot;,height:&quot;&quot;}),a.dom.removeClass(c,&quot;mceItemVisualAid&quot;),a.dom.removeClass(c,&quot;mceItemLayer&quot;)):(c.style.left||(c.style.left=&quot;20px&quot;),c.style.top||(c.style.top=&quot;20px&quot;),c.style.width||(c.style.width=c.width?c.width+&quot;px&quot;:&quot;100px&quot;),c.style.height||(c.style.height=c.height?c.height+&quot;px&quot;:&quot;100px&quot;),c.style.position=&quot;absolute&quot;,a.dom.setAttrib(c,&quot;data-mce-style&quot;,&quot;&quot;),a.addVisual(a.getBody())),a.execCommand(&quot;mceRepaint&quot;),a.nodeChanged())}a.addCommand(&quot;mceInsertLayer&quot;,e),a.addCommand(&quot;mceMoveForward&quot;,function(){d(1)}),a.addCommand(&quot;mceMoveBackward&quot;,function(){d(-1)}),a.addCommand(&quot;mceMakeAbsolute&quot;,function(){f()}),a.addButton(&quot;moveforward&quot;,{title:&quot;layer.forward_desc&quot;,cmd:&quot;mceMoveForward&quot;}),a.addButton(&quot;movebackward&quot;,{title:&quot;layer.backward_desc&quot;,cmd:&quot;mceMoveBackward&quot;}),a.addButton(&quot;absolute&quot;,{title:&quot;layer.absolute_desc&quot;,cmd:&quot;mceMakeAbsolute&quot;}),a.addButton(&quot;insertlayer&quot;,{title:&quot;layer.insertlayer_desc&quot;,cmd:&quot;mceInsertLayer&quot;}),a.on(&quot;init&quot;,function(){tinymce.Env.ie&amp;&amp;a.getDoc().execCommand(&quot;2D-Position&quot;,!1,!0)}),a.on(&quot;mouseup&quot;,function(c){var d=b(c.target);d&amp;&amp;a.dom.setAttrib(d,&quot;data-mce-style&quot;,&quot;&quot;)}),a.on(&quot;mousedown&quot;,function(c){var d,e=c.target,f=a.getDoc();tinymce.Env.gecko&amp;&amp;(b(e)?&quot;on&quot;!==f.designMode&amp;&amp;(f.designMode=&quot;on&quot;,e=f.body,d=e.parentNode,d.removeChild(e),d.appendChild(e)):&quot;on&quot;==f.designMode&amp;&amp;(f.designMode=&quot;off&quot;))}),a.on(&quot;NodeChange&quot;,c)});</pre>
</body>
</html>
