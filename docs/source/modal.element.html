<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * Created with JetBrains RubyMine.
 * User: teamco
 * Date: 11/24/12
 * Time: 10:12 PM
 * To change this template use File | Settings | File Templates.
 */

define([
    &#39;modules/base&#39;,
    &#39;modules/element&#39;,
    &#39;element/button.element&#39;,
    &#39;element/cover.element&#39;
], function defineModal(Base, BaseElement, Button, Cover) {

    require([&#39;jqueryui&#39;]);

    var Modal = function Modal(view, opts) {

<span id='global-property-S-buttons'>        /**
</span>         * Set button elements
         * @type {$modal.$buttons}
         */
        this.$buttons = {};

        this.setup(opts);

        this._config(view, opts, $(&#39;&lt;div /&gt;&#39;)).build({
            $container: opts.$container,
            destroy: true
        }).$.addClass(&#39;modal-dialog&#39;);

        this.renderInnerContent();
        this.setCover();

        return this;
    };

    return Modal.extend({

<span id='global-method-setup'>        /**
</span>         * Setup modal dialog
         * @param {{
         *      [style]: String,
         *      [cover]: Boolean,
         *      [opacityOff]: Number,
         *      [opacityOn]: Number,
         *      [title]: String,
         *      [type]: String (&#39;info&#39;, &#39;success&#39;, &#39;warning&#39;, &#39;error&#39;),
         *      [position]: String (&#39;0/00/000&#39;, &#39;1/11/111&#39;. &#39;2/22/222&#39;),
         *      [html]: String,
         *      [text]: String,
         *      [draggable]: Boolean,
         *      [autoclose]: Boolean,
         *      [coverOpacity]: Number
         *      $container,
         *      [css],
         *      [items],
         *      [buttons]
         * }} opts
         */
        setup: function setup(opts) {

<span id='global-property-title'>            /**
</span>             * Set modal title
             * @type {$modal.title: String}
             */
            this.title = opts.title;

<span id='global-property-type'>            /**
</span>             * Set modal type [&#39;error&#39;, &#39;warning&#39;, &#39;success&#39;, &#39;info&#39;]
             * @type {$modal.type: String}
             */
            this.type = opts.type;

<span id='global-property-html'>            /**
</span>             * Set modal html
             * @type {$modal.html: String}
             */
            this.html = opts.html;

<span id='global-property-text'>            /**
</span>             * Set modal text
             * @type {$modal.text: String}
             */
            this.text = opts.text;

<span id='global-property-items'>            /**
</span>             * Set modal item dependency (called from)
             * @type {$modal.items}
             */
            this.items = opts.items;

<span id='global-property-style'>            /**
</span>             * Set modal style
             * @type {$modal.style: String}
             */
            this.style = opts.style || &#39;&#39;;

<span id='global-property-css'>            /**
</span>             * Set modal css
             * @type {$modal.css}
             */
            this.css = opts.css || {};

<span id='global-property-hover'>            /**
</span>             * Set hover opacity
             * @type {$modal.hover: Boolean}
             */
            this.hover = this.base.defineBoolean(opts.hover, true, true);

<span id='global-property-opacityOff'>            /**
</span>             * Set modal opacity hover out
             * @type {$modal.opacityOff: Number}
             */
            this.opacityOff = opts.opacityOff || 0.8;

<span id='global-property-opacityOn'>            /**
</span>             * Set modal opacity hover in
             * @type {$modal.opacityOn: Number}
             */
            this.opacityOn = opts.opacityOn || 0.9;

<span id='global-property-S-container'>            /**
</span>             * Set modal parent container
             * @type {$modal.$container}
             */
            this.$container = opts.$container || $(&#39;body&#39;);

<span id='global-property-position'>            /**
</span>             * Set modal position:
             *      [&#39;tl&#39; &#39;tc&#39; &#39;tr&#39;]
             *      [&#39;cl&#39; &#39;cc&#39; &#39;cr&#39;]
             *      [&#39;bl&#39; &#39;bc&#39; &#39;br&#39;]
             * @type {$modal}
             */
            this.position = opts.position || &#39;cc&#39;;

<span id='global-property-draggable'>            /**
</span>             * Set modal is draggable condition
             * @type {$modal.draggable: Boolean}
             */
            this.draggable = this.base.defineBoolean(opts.draggable, true, true);

<span id='global-property-closeX'>            /**
</span>             * Set close X button
             * @type {$modal.closeX: Boolean}
             */
            this.closeX = this.base.defineBoolean(opts.draggable, true, true);

<span id='global-property-cover'>            /**
</span>             * Set cover config
             * @type {$modal.cover: Boolean}
             */
            this.cover = this.base.defineBoolean(opts.cover, true, true);

<span id='global-property-autoclose'>            /**
</span>             * Set close modal on click cover
             * @type {$modal.autoclose: Boolean}
             */
            this.autoclose = this.base.defineBoolean(opts.autoclose, false, true);

<span id='global-property-coverOpacity'>            /**
</span>             * Set cover opacity
             * @type {$modal.coverOpacity: Number}
             */
            this.coverOpacity = opts.coverOpacity;

<span id='global-property-buttons'>            /**
</span>             * Set buttons config
             * @type {$modal.buttons|{}}
             */
            this.buttons = opts.buttons || {};
        },

<span id='global-method-renderInnerContent'>        /**
</span>         * Render inner content
         */
        renderInnerContent: function renderInnerContent() {
            this.$.append(
                    [
                        &#39;&lt;h2 class=&quot;header&quot;&gt;&lt;/h2&gt;&#39;,
                        &#39;&lt;ul class=&quot;actions&quot;&gt;&lt;/ul&gt;&#39;,
                        &#39;&lt;div class=&quot;content&quot;&gt;&#39;,
                        &#39;&lt;div class=&quot;html&quot;&gt;&lt;/div&gt;&#39;,
                        &#39;&lt;p class=&quot;text&quot;&gt;&lt;/p&gt;&#39;,
                        &#39;&lt;/div&gt;&#39;,
                        &#39;&lt;ul class=&quot;buttons&quot;&gt;&lt;/ul&gt;&#39;
                    ].join(&#39;&#39;)
                ).
                addClass([this.style, this.type].join(&#39; &#39;)).
                css(this.css);

            this.setHeader();
            this.setHTML();
            this.setText();
            this.setHover();

            this.setPosition({
                $container: this.$container,
                $item: this.$,
                position: this.position
            });

            if (this.draggable) {
                this.$.draggable({
                    handle: this._getHeader()
                });
            }

            this.setButtons();
        },

<span id='global-method-_setCloseX'>        /**
</span>         * Set close X button
         * @returns {boolean|undefined}
         * @private
         */
        _setCloseX: function _setCloseX() {
            var $actions = this._getActions();
            if (!this.closeX) {
                $actions.hide();
                return false;
            }

            this.buttons[&#39;closeX&#39;] = {
                $container: this._getActions(),
                text: &#39;Close&#39;,
                events: {
                    click: &#39;rejectItemDestroy&#39;
                }
            };
        },

<span id='global-method-setButtons'>        /**
</span>         * Set buttons
         */
        setButtons: function setButtons() {
            var $container = this._getButtons();
            $.each(this.buttons, function each(i, button) {
                button.$container = $container;
            });

            this._setCloseX();

            this.view.button(Button, this.buttons, this.$buttons);
        },

<span id='global-method-unsetButtons'>        /**
</span>         * Unset buttons
         */
        unsetButtons: function unsetButtons() {
            $.each(this.$buttons, function each(i, $button) {
                $button.destroy();
            });
        },

<span id='global-method-setHeader'>        /**
</span>         * Set header
         */
        setHeader: function setHeader() {
            var $header = this._getHeader();
            this.base.isDefined(this.title) ?
                $header.text(this.title) :
                $header.hide();
        },

<span id='global-method-setHTML'>        /**
</span>         * Set HTML
         */
        setHTML: function setHTML() {
            var $html = this._getHTML();
            this.base.isDefined(this.html) ?
                $html.append(this.html) :
                $html.hide();
        },

<span id='global-method-setText'>        /**
</span>         * Set text
         */
        setText: function setText() {
            var $text = this._getText();
            this.base.isDefined(this.text) ?
                $text.text(this.text) :
                $text.hide();
        },

<span id='global-method-_getActions'>        /**
</span>         * Get action buttons container
         * @returns {*}
         * @private
         */
        _getActions: function _getActions() {
            return this.$.find(&#39;ul.actions&#39;);
        },

<span id='global-method-_getHTML'>        /**
</span>         * Get HTML container
         * @returns {*}
         * @private
         */
        _getHTML: function _getHTML() {
            return this.$.find(&#39;div.html&#39;);
        },

<span id='global-method-_getText'>        /**
</span>         * Get text container
         * @returns {*}
         * @private
         */
        _getText: function _getText() {
            return this.$.find(&#39;p.text&#39;);
        },

<span id='global-method-_getButtons'>        /**
</span>         * Get buttons container
         * @returns {*}
         * @private
         */
        _getButtons: function _getButtons() {
            return this.$.find(&#39;ul.buttons&#39;);
        },

<span id='global-method-_getHeader'>        /**
</span>         * Get header container
         * @returns {*}
         * @private
         */
        _getHeader: function _getHeader() {
            return this.$.find(&#39;h2&#39;);
        },

<span id='global-method-setHover'>        /**
</span>         * Set opacity on hover
         */
        setHover: function setHover() {
            if (this.hover) {
                this.$.hover(
                    function on() {
                        this.$.css(&#39;opacity&#39;, this.opacityOn);
                    }.bind(this),
                    function Off() {
                        this.$.css(&#39;opacity&#39;, this.opacityOff);
                    }.bind(this)
                );

                this.$.css(&#39;opacity&#39;, this.opacityOn);
            }
        },

<span id='global-method-unsetHover'>        /**
</span>         * Unset hover
         */
        unsetHover: function unsetHover() {
            this.$.unbind(&#39;mouseenter mouseleave&#39;).
                css(&#39;opacity&#39;, 1);
        },

<span id='global-method-setCover'>        /**
</span>         * Set cover
         */
        setCover: function setCover() {
            if (this.cover) {
                this.$cover = this.view.cover(Cover, {
                    $container: this.$container,
                    opacity: this.coverOpacity,
                    style: &#39;cover-&#39; + this.style,
                    events: this.autoclose ? { click: &#39;rejectItemDestroy&#39; } : {}
                });
            }
        },

<span id='global-method-unsetCover'>        /**
</span>         * Unset cover
         */
        unsetCover: function unsetCover() {
            if (this.$cover) {
                this.$cover.destroy();
            }
        },

<span id='global-method-selfDestroy'>        /**
</span>         * Self destroy functionality
         */
        selfDestroy: function selfDestroy() {
            this.unsetButtons();
            this.unsetCover();
            this.destroy();
        }

    }, Base, BaseElement.prototype);
});</pre>
</body>
</html>
