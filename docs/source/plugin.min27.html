<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">tinymce.PluginManager.add(&quot;noneditable&quot;,function(a){function b(a){var b;if(1===a.nodeType){if(b=a.getAttribute(k),b&amp;&amp;&quot;inherit&quot;!==b)return b;if(b=a.contentEditable,&quot;inherit&quot;!==b)return b}return null}function c(a){for(var c;a;){if(c=b(a))return&quot;false&quot;===c?a:null;a=a.parentNode}}function d(){function d(a){for(;a;){if(a.id===n)return a;a=a.parentNode}}function e(a){var b;if(a)for(b=new i(a,a),a=b.current();a;a=b.next())if(3===a.nodeType)return a}function f(c,d){var e,f;return&quot;false&quot;===b(c)&amp;&amp;k.isBlock(c)?void m.select(c):(f=k.createRng(),&quot;true&quot;===b(c)&amp;&amp;(c.firstChild||c.appendChild(a.getDoc().createTextNode(&quot;\xa0&quot;)),c=c.firstChild,d=!0),e=k.create(&quot;span&quot;,{id:n,&quot;data-mce-bogus&quot;:!0},o),d?c.parentNode.insertBefore(e,c):k.insertAfter(e,c),f.setStart(e.firstChild,1),f.collapse(!0),m.setRng(f),e)}function g(a){var b,c,f,g;if(a)b=m.getRng(!0),b.setStartBefore(a),b.setEndBefore(a),c=e(a),c&amp;&amp;c.nodeValue.charAt(0)==o&amp;&amp;(c=c.deleteData(0,1)),k.remove(a,!0),m.setRng(b);else for(f=d(m.getStart());(a=k.get(n))&amp;&amp;a!==g;)f!==a&amp;&amp;(c=e(a),c&amp;&amp;c.nodeValue.charAt(0)==o&amp;&amp;(c=c.deleteData(0,1)),k.remove(a,!0)),g=a}function h(){function a(a,c){var d,e,f,g,h;if(d=j.startContainer,e=j.startOffset,3==d.nodeType){if(h=d.nodeValue.length,e&gt;0&amp;&amp;h&gt;e||(c?e==h:0===e))return}else{if(!(e&lt;d.childNodes.length))return c?null:a;var k=!c&amp;&amp;e&gt;0?e-1:e;d=d.childNodes[k],d.hasChildNodes()&amp;&amp;(d=d.firstChild)}for(f=new i(d,a);g=f[c?&quot;prev&quot;:&quot;next&quot;]();){if(3===g.nodeType&amp;&amp;g.nodeValue.length&gt;0)return;if(&quot;true&quot;===b(g))return g}return a}var d,e,h,j,k;g(),h=m.isCollapsed(),d=c(m.getStart()),e=c(m.getEnd()),(d||e)&amp;&amp;(j=m.getRng(!0),h?(d=d||e,(k=a(d,!0))?f(k,!0):(k=a(d,!1))?f(k,!1):m.select(d)):(j=m.getRng(!0),d&amp;&amp;j.setStartBefore(d),e&amp;&amp;j.setEndAfter(e),m.setRng(j)))}function j(e){function f(a,b){for(;a=a[b?&quot;previousSibling&quot;:&quot;nextSibling&quot;];)if(3!==a.nodeType||a.nodeValue.length&gt;0)return a}function j(a,b){m.select(a),m.collapse(b)}function n(e){function f(a){for(var b=j;b;){if(b===a)return;b=b.parentNode}k.remove(a),h()}function g(){var d,g,h=a.schema.getNonEmptyElements();for(g=new tinymce.dom.TreeWalker(j,a.getBody());(d=e?g.prev():g.next())&amp;&amp;!h[d.nodeName.toLowerCase()]&amp;&amp;!(3===d.nodeType&amp;&amp;tinymce.trim(d.nodeValue).length&gt;0);)if(&quot;false&quot;===b(d))return f(d),!0;return c(d)?!0:!1}var i,j,l,n;if(m.isCollapsed()){if(i=m.getRng(!0),j=i.startContainer,l=i.startOffset,j=d(j)||j,n=c(j))return f(n),!1;if(3==j.nodeType&amp;&amp;(e?l&gt;0:l&lt;j.nodeValue.length))return!0;if(1==j.nodeType&amp;&amp;(j=j.childNodes[l]||j),g())return!1}return!0}var o,p,q,r,s=e.keyCode;if(q=m.getStart(),r=m.getEnd(),o=c(q)||c(r),o&amp;&amp;(112&gt;s||s&gt;124)&amp;&amp;s!=l.DELETE&amp;&amp;s!=l.BACKSPACE){if((tinymce.isMac?e.metaKey:e.ctrlKey)&amp;&amp;(67==s||88==s||86==s))return;if(e.preventDefault(),s==l.LEFT||s==l.RIGHT){var t=s==l.LEFT;if(a.dom.isBlock(o)){var u=t?o.previousSibling:o.nextSibling,v=new i(u,u),w=t?v.prev():v.next();j(w,!t)}else j(o,t)}}else if(s==l.LEFT||s==l.RIGHT||s==l.BACKSPACE||s==l.DELETE){if(p=d(q)){if(s==l.LEFT||s==l.BACKSPACE)if(o=f(p,!0),o&amp;&amp;&quot;false&quot;===b(o)){if(e.preventDefault(),s!=l.LEFT)return void k.remove(o);j(o,!0)}else g(p);if(s==l.RIGHT||s==l.DELETE)if(o=f(p),o&amp;&amp;&quot;false&quot;===b(o)){if(e.preventDefault(),s!=l.RIGHT)return void k.remove(o);j(o,!1)}else g(p)}if((s==l.BACKSPACE||s==l.DELETE)&amp;&amp;!n(s==l.BACKSPACE))return e.preventDefault(),!1}}var k=a.dom,m=a.selection,n=&quot;mce_noneditablecaret&quot;,o=&quot;\ufeff&quot;;a.on(&quot;mousedown&quot;,function(c){var d=a.selection.getNode();&quot;false&quot;===b(d)&amp;&amp;d==c.target&amp;&amp;h()}),a.on(&quot;mouseup keyup&quot;,h),a.on(&quot;keydown&quot;,j)}function e(b){var c=h.length,d=b.content,e=tinymce.trim(g);if(&quot;raw&quot;!=b.format){for(;c--;)d=d.replace(h[c],function(b){var c=arguments,f=c[c.length-2];return f&gt;0&amp;&amp;&#39;&quot;&#39;==d.charAt(f-1)?b:&#39;&lt;span class=&quot;&#39;+e+&#39;&quot; data-mce-content=&quot;&#39;+a.dom.encode(c[0])+&#39;&quot;&gt;&#39;+a.dom.encode(&quot;string&quot;==typeof c[1]?c[1]:c[0])+&quot;&lt;/span&gt;&quot;});b.content=d}}var f,g,h,i=tinymce.dom.TreeWalker,j=&quot;contenteditable&quot;,k=&quot;data-mce-&quot;+j,l=tinymce.util.VK;f=&quot; &quot;+tinymce.trim(a.getParam(&quot;noneditable_editable_class&quot;,&quot;mceEditable&quot;))+&quot; &quot;,g=&quot; &quot;+tinymce.trim(a.getParam(&quot;noneditable_noneditable_class&quot;,&quot;mceNonEditable&quot;))+&quot; &quot;,h=a.getParam(&quot;noneditable_regexp&quot;),h&amp;&amp;!h.length&amp;&amp;(h=[h]),a.on(&quot;PreInit&quot;,function(){d(),h&amp;&amp;a.on(&quot;BeforeSetContent&quot;,e),a.parser.addAttributeFilter(&quot;class&quot;,function(a){for(var b,c,d=a.length;d--;)c=a[d],b=&quot; &quot;+c.attr(&quot;class&quot;)+&quot; &quot;,-1!==b.indexOf(f)?c.attr(k,&quot;true&quot;):-1!==b.indexOf(g)&amp;&amp;c.attr(k,&quot;false&quot;)}),a.serializer.addAttributeFilter(k,function(a){for(var b,c=a.length;c--;)b=a[c],h&amp;&amp;b.attr(&quot;data-mce-content&quot;)?(b.name=&quot;#text&quot;,b.type=3,b.raw=!0,b.value=b.attr(&quot;data-mce-content&quot;)):(b.attr(j,null),b.attr(k,null))}),a.parser.addAttributeFilter(j,function(a){for(var b,c=a.length;c--;)b=a[c],b.attr(k,b.attr(j)),b.attr(j,null)})}),a.on(&quot;drop&quot;,function(a){c(a.target)&amp;&amp;a.preventDefault()})});</pre>
</body>
</html>
