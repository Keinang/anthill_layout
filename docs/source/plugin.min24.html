<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">tinymce.PluginManager.add(&quot;lists&quot;,function(a){function b(a){return a&amp;&amp;/^(OL|UL|DL)$/.test(a.nodeName)}function c(a){return a.parentNode.firstChild==a}function d(a){return a.parentNode.lastChild==a}function e(b){return b&amp;&amp;!!a.schema.getTextBlockElements()[b.nodeName]}var f=this;a.on(&quot;init&quot;,function(){function g(a){function b(b){var d,e,f;e=a[b?&quot;startContainer&quot;:&quot;endContainer&quot;],f=a[b?&quot;startOffset&quot;:&quot;endOffset&quot;],1==e.nodeType&amp;&amp;(d=v.create(&quot;span&quot;,{&quot;data-mce-type&quot;:&quot;bookmark&quot;}),e.hasChildNodes()?(f=Math.min(f,e.childNodes.length-1),b?e.insertBefore(d,e.childNodes[f]):v.insertAfter(d,e.childNodes[f])):e.appendChild(d),e=d,f=0),c[b?&quot;startContainer&quot;:&quot;endContainer&quot;]=e,c[b?&quot;startOffset&quot;:&quot;endOffset&quot;]=f}var c={};return b(!0),a.collapsed||b(),c}function h(a){function b(b){function c(a){for(var b=a.parentNode.firstChild,c=0;b;){if(b==a)return c;(1!=b.nodeType||&quot;bookmark&quot;!=b.getAttribute(&quot;data-mce-type&quot;))&amp;&amp;c++,b=b.nextSibling}return-1}var d,e,f;d=f=a[b?&quot;startContainer&quot;:&quot;endContainer&quot;],e=a[b?&quot;startOffset&quot;:&quot;endOffset&quot;],d&amp;&amp;(1==d.nodeType&amp;&amp;(e=c(d),d=d.parentNode,v.remove(f)),a[b?&quot;startContainer&quot;:&quot;endContainer&quot;]=d,a[b?&quot;startOffset&quot;:&quot;endOffset&quot;]=e)}b(!0),b();var c=v.createRng();c.setStart(a.startContainer,a.startOffset),a.endContainer&amp;&amp;c.setEnd(a.endContainer,a.endOffset),w.setRng(c)}function i(b,c){var d,e,f,g=v.createFragment(),h=a.schema.getBlockElements();if(a.settings.forced_root_block&amp;&amp;(c=c||a.settings.forced_root_block),c&amp;&amp;(e=v.create(c),e.tagName===a.settings.forced_root_block&amp;&amp;v.setAttribs(e,a.settings.forced_root_block_attrs),g.appendChild(e)),b)for(;d=b.firstChild;){var i=d.nodeName;f||&quot;SPAN&quot;==i&amp;&amp;&quot;bookmark&quot;==d.getAttribute(&quot;data-mce-type&quot;)||(f=!0),h[i]?(g.appendChild(d),e=null):c?(e||(e=v.create(c),g.appendChild(e)),e.appendChild(d)):g.appendChild(d)}return a.settings.forced_root_block?f||tinymce.Env.ie&amp;&amp;!(tinymce.Env.ie&gt;10)||e.appendChild(v.create(&quot;br&quot;,{&quot;data-mce-bogus&quot;:&quot;1&quot;})):g.appendChild(v.create(&quot;br&quot;)),g}function j(){return tinymce.grep(w.getSelectedBlocks(),function(a){return/^(LI|DT|DD)$/.test(a.nodeName)})}function k(a,b,c){var d,e,f=v.select(&#39;span[data-mce-type=&quot;bookmark&quot;]&#39;,a);c=c||i(b),d=v.createRng(),d.setStartAfter(b),d.setEndAfter(a),e=d.extractContents(),v.isEmpty(e)||v.insertAfter(e,a),v.insertAfter(c,a),v.isEmpty(b.parentNode)&amp;&amp;(tinymce.each(f,function(a){b.parentNode.parentNode.insertBefore(a,b.parentNode)}),v.remove(b.parentNode)),v.remove(b)}function l(a){var c,d;if(c=a.nextSibling,c&amp;&amp;b(c)&amp;&amp;c.nodeName==a.nodeName){for(;d=c.firstChild;)a.appendChild(d);v.remove(c)}if(c=a.previousSibling,c&amp;&amp;b(c)&amp;&amp;c.nodeName==a.nodeName){for(;d=c.firstChild;)a.insertBefore(d,a.firstChild);v.remove(c)}}function m(a){tinymce.each(tinymce.grep(v.select(&quot;ol,ul&quot;,a)),function(a){var c,d=a.parentNode;&quot;LI&quot;==d.nodeName&amp;&amp;d.firstChild==a&amp;&amp;(c=d.previousSibling,c&amp;&amp;&quot;LI&quot;==c.nodeName&amp;&amp;(c.appendChild(a),v.isEmpty(d)&amp;&amp;v.remove(d))),b(d)&amp;&amp;(c=d.previousSibling,c&amp;&amp;&quot;LI&quot;==c.nodeName&amp;&amp;c.appendChild(a))})}function n(a){function e(a){v.isEmpty(a)&amp;&amp;v.remove(a)}var f,g=a.parentNode,h=g.parentNode;return&quot;DD&quot;==a.nodeName?(v.rename(a,&quot;DT&quot;),!0):c(a)&amp;&amp;d(a)?(&quot;LI&quot;==h.nodeName?(v.insertAfter(a,h),e(h),v.remove(g)):b(h)?v.remove(g,!0):(h.insertBefore(i(a),g),v.remove(g)),!0):c(a)?(&quot;LI&quot;==h.nodeName?(v.insertAfter(a,h),a.appendChild(g),e(h)):b(h)?h.insertBefore(a,g):(h.insertBefore(i(a),g),v.remove(a)),!0):d(a)?(&quot;LI&quot;==h.nodeName?v.insertAfter(a,h):b(h)?v.insertAfter(a,g):(v.insertAfter(i(a),g),v.remove(a)),!0):(&quot;LI&quot;==h.nodeName?(g=h,f=i(a,&quot;LI&quot;)):f=b(h)?i(a,&quot;LI&quot;):i(a),k(g,a,f),m(g.parentNode),!0)}function o(a){function c(c,d){var e;if(b(c)){for(;e=a.lastChild.firstChild;)d.appendChild(e);v.remove(c)}}var d,e;return&quot;DT&quot;==a.nodeName?(v.rename(a,&quot;DD&quot;),!0):(d=a.previousSibling,d&amp;&amp;b(d)?(d.appendChild(a),!0):d&amp;&amp;&quot;LI&quot;==d.nodeName&amp;&amp;b(d.lastChild)?(d.lastChild.appendChild(a),c(a.lastChild,d.lastChild),!0):(d=a.nextSibling,d&amp;&amp;b(d)?(d.insertBefore(a,d.firstChild),!0):d&amp;&amp;&quot;LI&quot;==d.nodeName&amp;&amp;b(a.lastChild)?!1:(d=a.previousSibling,d&amp;&amp;&quot;LI&quot;==d.nodeName?(e=v.create(a.parentNode.nodeName),d.appendChild(e),e.appendChild(a),c(a.lastChild,e),!0):!1)))}function p(){var b=j();if(b.length){for(var c=g(w.getRng(!0)),d=0;d&lt;b.length&amp;&amp;(o(b[d])||0!==d);d++);return h(c),a.nodeChanged(),!0}}function q(){var b=j();if(b.length){var c,d,e=g(w.getRng(!0)),f=a.getBody();for(c=b.length;c--;)for(var i=b[c].parentNode;i&amp;&amp;i!=f;){for(d=b.length;d--;)if(b[d]===i){b.splice(c,1);break}i=i.parentNode}for(c=0;c&lt;b.length&amp;&amp;(n(b[c])||0!==c);c++);return h(e),a.nodeChanged(),!0}}function r(c){function d(){function b(a){var b,c;for(b=f[a?&quot;startContainer&quot;:&quot;endContainer&quot;],c=f[a?&quot;startOffset&quot;:&quot;endOffset&quot;],1==b.nodeType&amp;&amp;(b=b.childNodes[Math.min(c,b.childNodes.length-1)]||b);b.parentNode!=g;){if(e(b))return b;if(/^(TD|TH)$/.test(b.parentNode.nodeName))return b;b=b.parentNode}return b}for(var c,d=[],g=a.getBody(),h=b(!0),i=b(),j=[],k=h;k&amp;&amp;(j.push(k),k!=i);k=k.nextSibling);return tinymce.each(j,function(a){if(e(a))return d.push(a),void(c=null);if(v.isBlock(a)||&quot;BR&quot;==a.nodeName)return&quot;BR&quot;==a.nodeName&amp;&amp;v.remove(a),void(c=null);var b=a.nextSibling;return tinymce.dom.BookmarkManager.isBookmarkNode(a)&amp;&amp;(e(b)||!b&amp;&amp;a.parentNode==g)?void(c=null):(c||(c=v.create(&quot;p&quot;),a.parentNode.insertBefore(c,a),d.push(c)),void c.appendChild(a))}),d}var f=w.getRng(!0),i=g(f),j=&quot;LI&quot;;c=c.toUpperCase(),&quot;DL&quot;==c&amp;&amp;(j=&quot;DT&quot;),tinymce.each(d(),function(a){var d,e;e=a.previousSibling,e&amp;&amp;b(e)&amp;&amp;e.nodeName==c?(d=e,a=v.rename(a,j),e.appendChild(a)):(d=v.create(c),a.parentNode.insertBefore(d,a),d.appendChild(a),a=v.rename(a,j)),l(d)}),h(i)}function s(){var c=g(w.getRng(!0)),d=a.getBody();tinymce.each(j(),function(a){var c,e;if(v.isEmpty(a))return void n(a);for(c=a;c&amp;&amp;c!=d;c=c.parentNode)b(c)&amp;&amp;(e=c);k(e,a)}),h(c)}function t(a){var b=v.getParent(w.getStart(),&quot;OL,UL,DL&quot;);if(b)if(b.nodeName==a)s(a);else{var c=g(w.getRng(!0));l(v.rename(b,a)),h(c)}else r(a)}function u(b){return function(){var c=v.getParent(a.selection.getStart(),&quot;UL,OL,DL&quot;);return c&amp;&amp;c.nodeName==b}}var v=a.dom,w=a.selection;f.backspaceDelete=function(c){function d(b,c){var d,e,f=b.startContainer,g=b.startOffset;if(3==f.nodeType&amp;&amp;(c?g&lt;f.data.length:g&gt;0))return f;for(d=a.schema.getNonEmptyElements(),e=new tinymce.dom.TreeWalker(b.startContainer);f=e[c?&quot;next&quot;:&quot;prev&quot;]();){if(&quot;LI&quot;==f.nodeName&amp;&amp;!f.hasChildNodes())return f;if(d[f.nodeName])return f;if(3==f.nodeType&amp;&amp;f.data.length&gt;0)return f}}function e(a,c){var d,e,f=a.parentNode;if(b(c.lastChild)&amp;&amp;(e=c.lastChild),d=c.lastChild,d&amp;&amp;&quot;BR&quot;==d.nodeName&amp;&amp;a.hasChildNodes()&amp;&amp;v.remove(d),v.isEmpty(c)&amp;&amp;v.$(c).empty(),!v.isEmpty(a))for(;d=a.firstChild;)c.appendChild(d);e&amp;&amp;c.appendChild(e),v.remove(a),v.isEmpty(f)&amp;&amp;v.remove(f)}if(w.isCollapsed()){var f=v.getParent(w.getStart(),&quot;LI&quot;);if(f){var i=w.getRng(!0),j=v.getParent(d(i,c),&quot;LI&quot;);if(j&amp;&amp;j!=f){var k=g(i);return c?e(j,f):e(f,j),h(k),!0}if(!j&amp;&amp;!c&amp;&amp;s(f.parentNode.nodeName))return!0}}},a.addCommand(&quot;Indent&quot;,function(){return p()?void 0:!0}),a.addCommand(&quot;Outdent&quot;,function(){return q()?void 0:!0}),a.addCommand(&quot;InsertUnorderedList&quot;,function(){t(&quot;UL&quot;)}),a.addCommand(&quot;InsertOrderedList&quot;,function(){t(&quot;OL&quot;)}),a.addCommand(&quot;InsertDefinitionList&quot;,function(){t(&quot;DL&quot;)}),a.addQueryStateHandler(&quot;InsertUnorderedList&quot;,u(&quot;UL&quot;)),a.addQueryStateHandler(&quot;InsertOrderedList&quot;,u(&quot;OL&quot;)),a.addQueryStateHandler(&quot;InsertDefinitionList&quot;,u(&quot;DL&quot;)),a.on(&quot;keydown&quot;,function(b){9!=b.keyCode||tinymce.util.VK.metaKeyPressed(b)||a.dom.getParent(a.selection.getStart(),&quot;LI,DT,DD&quot;)&amp;&amp;(b.preventDefault(),b.shiftKey?q():p())})}),a.addButton(&quot;indent&quot;,{icon:&quot;indent&quot;,title:&quot;Increase indent&quot;,cmd:&quot;Indent&quot;,onPostRender:function(){var b=this;a.on(&quot;nodechange&quot;,function(){for(var d=a.selection.getSelectedBlocks(),e=!1,f=0,g=d.length;!e&amp;&amp;g&gt;f;f++){var h=d[f].nodeName;e=&quot;LI&quot;==h&amp;&amp;c(d[f])||&quot;UL&quot;==h||&quot;OL&quot;==h||&quot;DD&quot;==h}b.disabled(e)})}}),a.on(&quot;keydown&quot;,function(a){a.keyCode==tinymce.util.VK.BACKSPACE?f.backspaceDelete()&amp;&amp;a.preventDefault():a.keyCode==tinymce.util.VK.DELETE&amp;&amp;f.backspaceDelete(!0)&amp;&amp;a.preventDefault()})});</pre>
</body>
</html>
