<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * Created with JetBrains RubyMine.
 * User: teamco
 * Date: 5/6/13
 * Time: 9:32 PM
 */
define([
    &#39;config/anthill&#39;
], function defineDebuggerConfig(AntHill) {

<span id='DebuggerConfig-method-constructor'><span id='DebuggerConfig'>    /**
</span></span>     * Define Debugger Config
     * @class DebuggerConfig
     * @param {*} debug
     * @constructor
     */
    var DebuggerConfig = function DebuggerConfig(debug) {

<span id='DebuggerConfig-property-bugger'>        /**
</span>         * Define debugger
         * @type {Debugger}
         */
        this.bugger = debug;

        this.defineScope();

    };

    return DebuggerConfig.extend({

<span id='DebuggerConfig-method-defineScope'>        /**
</span>         * Define scope
         * @returns {*}
         */
        defineScope: function defineScope() {
            var scope = this.bugger.scope,
                item = scope.model.getItemNameSpace();

            while (item === &#39;object&#39; || typeof(item) !== &#39;undefined&#39;) {
                scope = this.setScope(scope, item);

                if (scope.constructor.name === &#39;Object&#39;) {
                    this.bugger.scope.logger.debug(&#39;Undefined scope&#39;, item);
                    return false;
                }

                item = scope.model.getItemNameSpace();
            }

            this.validateScopes();
        },

<span id='DebuggerConfig-method-validateScopes'>        /**
</span>         * Validate required scopes
         */
        validateScopes: function validateScopes() {
            var hash = this.base.define(this.bugger.scopes, {}, true),
                scopes = [&#39;Workspace&#39;, &#39;Page&#39;, &#39;Widget&#39;];

            if (this.base.lib.hash.hashLength(hash) &lt; scopes.length) {
                $.each(scopes, function each(index, value) {
                    this.bugger.scope.controller.checkCondition({
                        condition: !hash.hasOwnProperty(value.toLowerCase()),
                        msg: &#39;Undefined scope&#39;,
                        type: &#39;warn&#39;,
                        args: value
                    });
                }.bind(this));
            }
        },

<span id='DebuggerConfig-method-setScope'>        /**
</span>         * Set scope
         * @param {{}} scope
         * @param {String} item
         * @returns {*}
         */
        setScope: function setScope(scope, item) {
            var node = scope[item];

            if (node.constructor.name !== &#39;Object&#39;) {
                this.bugger.scopes[node.constructor.name.toLowerCase()] = node;
            }

            return node;
        },

<span id='DebuggerConfig-method-getItem'>        /**
</span>         * Get current item by type
         * @param {string} type
         * @returns {App|Workspace|Page|Widget}
         */
        getItem: function getItem(type) {
            var scope = {};

            scope.app = this.bugger.scope;
            scope.workspace = app.controller.getCurrentItem();
            scope.page = scope.workspace.controller.getCurrentItem();
            scope.widget = scope.page.controller.getCurrentItem();

            scope.app.logger.debug(&#39;Get item&#39;, scope, type);

            return scope[type];
        },

<span id='DebuggerConfig-method-setItem'>        /**
</span>         * Set item as current
         * @param {string} type
         * @param {string} uuid
         */
        setItem: function setItem(type, uuid) {
            var scope = this.getItem(type),
                item = scope.model.getItemByUUID(uuid);

            item.controller.setAsCurrent();

            scope.logger.debug(&#39;Current item&#39;, scope, item);

            return this.getItem(item.constructor.name.toLowerCase());
        }


    }, AntHill.prototype);

});</pre>
</body>
</html>
