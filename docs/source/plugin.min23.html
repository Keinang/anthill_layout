<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">tinymce.PluginManager.add(&quot;link&quot;,function(a){function b(b){return function(){var c=a.settings.link_list;&quot;string&quot;==typeof c?tinymce.util.XHR.send({url:c,success:function(a){b(tinymce.util.JSON.parse(a))}}):&quot;function&quot;==typeof c?c(b):b(c)}}function c(a,b,c){function d(a,c){return c=c||[],tinymce.each(a,function(a){var e={text:a.text||a.title};a.menu?e.menu=d(a.menu):(e.value=a.value,b&amp;&amp;b(e)),c.push(e)}),c}return d(a,c||[])}function d(b){function d(a){var b=l.find(&quot;#text&quot;);(!b.value()||a.lastControl&amp;&amp;b.value()==a.lastControl.text())&amp;&amp;b.value(a.control.text()),l.find(&quot;#href&quot;).value(a.control.value())}function e(b){var c=[];return tinymce.each(a.dom.select(&quot;a:not([href])&quot;),function(a){var d=a.name||a.id;d&amp;&amp;c.push({text:d,value:&quot;#&quot;+d,selected:-1!=b.indexOf(&quot;#&quot;+d)})}),c.length?(c.unshift({text:&quot;None&quot;,value:&quot;&quot;}),{name:&quot;anchor&quot;,type:&quot;listbox&quot;,label:&quot;Anchors&quot;,values:c,onselect:d}):void 0}function f(){!k&amp;&amp;0===u.text.length&amp;&amp;m&amp;&amp;this.parent().parent().find(&quot;#text&quot;)[0].value(this.value())}function g(b){var c=b.meta||{};o&amp;&amp;o.value(a.convertURL(this.value(),&quot;href&quot;)),tinymce.each(b.meta,function(a,b){l.find(&quot;#&quot;+b).value(a)}),c.text||f.call(this)}function h(a){var b=v.getContent();if(/&lt;/.test(b)&amp;&amp;(!/^&lt;a [^&gt;]+&gt;[^&lt;]+&lt;\/a&gt;$/.test(b)||-1==b.indexOf(&quot;href=&quot;)))return!1;if(a){var c,d=a.childNodes;if(0===d.length)return!1;for(c=d.length-1;c&gt;=0;c--)if(3!=d[c].nodeType)return!1}return!0}var i,j,k,l,m,n,o,p,q,r,s,t,u={},v=a.selection,w=a.dom;i=v.getNode(),j=w.getParent(i,&quot;a[href]&quot;),m=h(),u.text=k=j?j.innerText||j.textContent:v.getContent({format:&quot;text&quot;}),u.href=j?w.getAttrib(j,&quot;href&quot;):&quot;&quot;,(t=w.getAttrib(j,&quot;target&quot;))?u.target=t:a.settings.default_link_target&amp;&amp;(u.target=a.settings.default_link_target),(t=w.getAttrib(j,&quot;rel&quot;))&amp;&amp;(u.rel=t),(t=w.getAttrib(j,&quot;class&quot;))&amp;&amp;(u[&quot;class&quot;]=t),(t=w.getAttrib(j,&quot;title&quot;))&amp;&amp;(u.title=t),m&amp;&amp;(n={name:&quot;text&quot;,type:&quot;textbox&quot;,size:40,label:&quot;Text to display&quot;,onchange:function(){u.text=this.value()}}),b&amp;&amp;(o={type:&quot;listbox&quot;,label:&quot;Link list&quot;,values:c(b,function(b){b.value=a.convertURL(b.value||b.url,&quot;href&quot;)},[{text:&quot;None&quot;,value:&quot;&quot;}]),onselect:d,value:a.convertURL(u.href,&quot;href&quot;),onPostRender:function(){o=this}}),a.settings.target_list!==!1&amp;&amp;(a.settings.target_list||(a.settings.target_list=[{text:&quot;None&quot;,value:&quot;&quot;},{text:&quot;New window&quot;,value:&quot;_blank&quot;}]),q={name:&quot;target&quot;,type:&quot;listbox&quot;,label:&quot;Target&quot;,values:c(a.settings.target_list)}),a.settings.rel_list&amp;&amp;(p={name:&quot;rel&quot;,type:&quot;listbox&quot;,label:&quot;Rel&quot;,values:c(a.settings.rel_list)}),a.settings.link_class_list&amp;&amp;(r={name:&quot;class&quot;,type:&quot;listbox&quot;,label:&quot;Class&quot;,values:c(a.settings.link_class_list,function(b){b.value&amp;&amp;(b.textStyle=function(){return a.formatter.getCssText({inline:&quot;a&quot;,classes:[b.value]})})})}),a.settings.link_title!==!1&amp;&amp;(s={name:&quot;title&quot;,type:&quot;textbox&quot;,label:&quot;Title&quot;,value:u.title}),l=a.windowManager.open({title:&quot;Insert link&quot;,data:u,body:[{name:&quot;href&quot;,type:&quot;filepicker&quot;,filetype:&quot;file&quot;,size:40,autofocus:!0,label:&quot;Url&quot;,onchange:g,onkeyup:f},n,s,e(u.href),o,p,q,r],onSubmit:function(b){function c(b,c){var d=a.selection.getRng();window.setTimeout(function(){a.windowManager.confirm(b,function(b){a.selection.setRng(d),c(b)})},0)}function d(){var b={href:e,target:u.target?u.target:null,rel:u.rel?u.rel:null,&quot;class&quot;:u[&quot;class&quot;]?u[&quot;class&quot;]:null,title:u.title?u.title:null};j?(a.focus(),m&amp;&amp;u.text!=k&amp;&amp;(&quot;innerText&quot;in j?j.innerText=u.text:j.textContent=u.text),w.setAttribs(j,b),v.select(j),a.undoManager.add()):m?a.insertContent(w.createHTML(&quot;a&quot;,b,w.encode(u.text))):a.execCommand(&quot;mceInsertLink&quot;,!1,b)}var e;return u=tinymce.extend(u,b.data),(e=u.href)?e.indexOf(&quot;@&quot;)&gt;0&amp;&amp;-1==e.indexOf(&quot;//&quot;)&amp;&amp;-1==e.indexOf(&quot;mailto:&quot;)?void c(&quot;The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?&quot;,function(a){a&amp;&amp;(e=&quot;mailto:&quot;+e),d()}):/^\s*www\./i.test(e)?void c(&quot;The URL you entered seems to be an external link. Do you want to add the required http:// prefix?&quot;,function(a){a&amp;&amp;(e=&quot;http://&quot;+e),d()}):void d():void a.execCommand(&quot;unlink&quot;)}})}a.addButton(&quot;link&quot;,{icon:&quot;link&quot;,tooltip:&quot;Insert/edit link&quot;,shortcut:&quot;Ctrl+K&quot;,onclick:b(d),stateSelector:&quot;a[href]&quot;}),a.addButton(&quot;unlink&quot;,{icon:&quot;unlink&quot;,tooltip:&quot;Remove link&quot;,cmd:&quot;unlink&quot;,stateSelector:&quot;a[href]&quot;}),a.addShortcut(&quot;Ctrl+K&quot;,&quot;&quot;,b(d)),a.addCommand(&quot;mceLink&quot;,b(d)),this.showDialog=d,a.addMenuItem(&quot;link&quot;,{icon:&quot;link&quot;,text:&quot;Insert link&quot;,shortcut:&quot;Ctrl+K&quot;,onclick:b(d),stateSelector:&quot;a[href]&quot;,context:&quot;insert&quot;,prependToContext:!0})});</pre>
</body>
</html>
