<table>
  <thead>
  <tr>
    <th>ID</th>
    <th>UUID</th>
    <th>Type</th>
    <th>Key</th>
    <th>Preview</th>
    <th>Version</th>
    <th>Destroy</th>
    <th>Author</th>
  </tr>
  </thead>
  <tbody>
  <% @author_site_storages.each_with_index do |author_site_storage, index| %>
      <% versions = author_site_storage.author_site_versions %>
      <% activated_version = versions.where(activated: true).first %>
      <tr>
        <td><%= index + 1 %></td>
        <td><%= author_site_storage.uuid %></td>
        <td><%= author_site_storage.author_site_type.try(:name) %></td>
        <td class="name"><%= link_to author_site_storage.key, edit_author_site_storage_path(author_site_storage) %></td>
        <td><%= link_to "Show #{author_site_storage.key}", {}, {target: '_blank', href: "/sites/#{author_site_storage.key}"} %></td>
        <td class="c"><%= link_to "#{activated_version.try(:version) || '?'} (#{versions.length})", author_site_storage_site_versions_path(author_site_storage) %></td>
        <td class="c"><%= link_to_destroy(author_site_storage, author_site_storage.key) %></td>
        <td><%= edit_user(author_site_storage) %></td>
      </tr>
  <% end %>
  </tbody>
</table>